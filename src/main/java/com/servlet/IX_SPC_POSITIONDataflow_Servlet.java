package com.servlet;

import java.io.IOException;
import java.util.List;
import java.util.logging.Logger;

import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

import com.process.DataFlowProcessForJDA;
import com.process.DeleteErrorTable;
import com.process.MailUser;
import com.process.StorageService;
import com.utils.Constants;
import com.utils.SchemaDef.DelimiterType;

@SuppressWarnings("serial")
@WebServlet(
	    name = "IX_SPC_POSITIONDataflow_Servlet",
	    urlPatterns = {
	      "/ix_spc_position_df"})
public class IX_SPC_POSITIONDataflow_Servlet extends HttpServlet implements Constants{
	static Logger log = Logger.getLogger(IX_SPC_POSITIONDataflow_Servlet.class.getName());
	public void doGet(HttpServletRequest req, HttpServletResponse resp)
			throws IOException {
		String sampleSchema = "[{\"mode\": \"NULLABLE\",\"name\":\"DBTime\",\"type\":\"TIMESTAMP\",\"description\":\" DB time\"},{\"mode\": \"NULLABLE\",\"name\":\"DBUser\",\"type\":\"STRING\",\"description\":\" DB user\"},{\"mode\": \"NULLABLE\",\"name\":\"DBParentPlanogramKey\",\"type\":\"INTEGER\",\"description\":\" DB parent planogram key\"},{\"mode\": \"NULLABLE\",\"name\":\"DBParentFixtureKey\",\"type\":\"INTEGER\",\"description\":\" DB parent fixture key\"},{\"mode\": \"NULLABLE\",\"name\":\"DBParentProductKey\",\"type\":\"INTEGER\",\"description\":\" DB parent product key\"},{\"mode\": \"NULLABLE\",\"name\":\"DBParentPegKey\",\"type\":\"INTEGER\",\"description\":\" DB parent peg key\"},{\"mode\": \"NULLABLE\",\"name\":\"DBKey\",\"type\":\"INTEGER\",\"description\":\" DBKey\"},{\"mode\": \"NULLABLE\",\"name\":\"X\",\"type\":\"FLOAT\",\"description\":\" X\"},{\"mode\": \"NULLABLE\",\"name\":\"Width\",\"type\":\"FLOAT\",\"description\":\" Width\"},{\"mode\": \"NULLABLE\",\"name\":\"Y\",\"type\":\"FLOAT\",\"description\":\" Y\"},{\"mode\": \"NULLABLE\",\"name\":\"Height\",\"type\":\"FLOAT\",\"description\":\" Height\"},{\"mode\": \"NULLABLE\",\"name\":\"Z\",\"type\":\"FLOAT\",\"description\":\" Z\"},{\"mode\": \"NULLABLE\",\"name\":\"Depth\",\"type\":\"FLOAT\",\"description\":\" Depth\"},{\"mode\": \"NULLABLE\",\"name\":\"Slope\",\"type\":\"FLOAT\",\"description\":\" Slope\"},{\"mode\": \"NULLABLE\",\"name\":\"Angle\",\"type\":\"FLOAT\",\"description\":\" Angle\"},{\"mode\": \"NULLABLE\",\"name\":\"Roll\",\"type\":\"FLOAT\",\"description\":\" Roll\"},{\"mode\": \"NULLABLE\",\"name\":\"Changed\",\"type\":\"INTEGER\",\"description\":\" Changed\"},{\"mode\": \"NULLABLE\",\"name\":\"MerchStyle\",\"type\":\"INTEGER\",\"description\":\" Merch style\"},{\"mode\": \"NULLABLE\",\"name\":\"HFacings\",\"type\":\"INTEGER\",\"description\":\" HFacings\"},{\"mode\": \"NULLABLE\",\"name\":\"VFacings\",\"type\":\"INTEGER\",\"description\":\" VFacings\"},{\"mode\": \"NULLABLE\",\"name\":\"DFacings\",\"type\":\"INTEGER\",\"description\":\" DFacings\"},{\"mode\": \"NULLABLE\",\"name\":\"XCapNum\",\"type\":\"INTEGER\",\"description\":\" X cap num\"},{\"mode\": \"NULLABLE\",\"name\":\"XCapNested\",\"type\":\"INTEGER\",\"description\":\" X cap nested\"},{\"mode\": \"NULLABLE\",\"name\":\"XCapReversed\",\"type\":\"INTEGER\",\"description\":\" X cap reversed\"},{\"mode\": \"NULLABLE\",\"name\":\"XCapOrientation\",\"type\":\"INTEGER\",\"description\":\" X cap orientation\"},{\"mode\": \"NULLABLE\",\"name\":\"YCapNum\",\"type\":\"INTEGER\",\"description\":\" Y cap num\"},{\"mode\": \"NULLABLE\",\"name\":\"YCapNested\",\"type\":\"INTEGER\",\"description\":\" Y cap nested\"},{\"mode\": \"NULLABLE\",\"name\":\"YCapReversed\",\"type\":\"INTEGER\",\"description\":\" Y cap reversed\"},{\"mode\": \"NULLABLE\",\"name\":\"YCapOrientation\",\"type\":\"INTEGER\",\"description\":\" Y cap orientation\"},{\"mode\": \"NULLABLE\",\"name\":\"ZCapNum\",\"type\":\"INTEGER\",\"description\":\" Z cap num\"},{\"mode\": \"NULLABLE\",\"name\":\"ZCapNested\",\"type\":\"INTEGER\",\"description\":\" Z cap nested\"},{\"mode\": \"NULLABLE\",\"name\":\"ZCapReversed\",\"type\":\"INTEGER\",\"description\":\" Z cap reversed\"},{\"mode\": \"NULLABLE\",\"name\":\"ZCapOrientation\",\"type\":\"INTEGER\",\"description\":\" Z cap orientation\"},{\"mode\": \"NULLABLE\",\"name\":\"Orientation\",\"type\":\"INTEGER\",\"description\":\" Orientation\"},{\"mode\": \"NULLABLE\",\"name\":\"JumbleWidth\",\"type\":\"FLOAT\",\"description\":\" Jumble width\"},{\"mode\": \"NULLABLE\",\"name\":\"JumbleHeight\",\"type\":\"FLOAT\",\"description\":\" Jumble height\"},{\"mode\": \"NULLABLE\",\"name\":\"JumbleDepth\",\"type\":\"FLOAT\",\"description\":\" Jumble depth\"},{\"mode\": \"NULLABLE\",\"name\":\"MerchStyleWidth\",\"type\":\"FLOAT\",\"description\":\" Merch style width\"},{\"mode\": \"NULLABLE\",\"name\":\"MerchStyleHeight\",\"type\":\"FLOAT\",\"description\":\" Merch style height\"},{\"mode\": \"NULLABLE\",\"name\":\"MerchStyleDepth\",\"type\":\"FLOAT\",\"description\":\" Merch style depth\"},{\"mode\": \"NULLABLE\",\"name\":\"FullWidth\",\"type\":\"FLOAT\",\"description\":\" Full width\"},{\"mode\": \"NULLABLE\",\"name\":\"FullHeight\",\"type\":\"FLOAT\",\"description\":\" Full height\"},{\"mode\": \"NULLABLE\",\"name\":\"FullDepth\",\"type\":\"FLOAT\",\"description\":\" Full depth\"},{\"mode\": \"NULLABLE\",\"name\":\"XSubUnits\",\"type\":\"INTEGER\",\"description\":\" X sub units\"},{\"mode\": \"NULLABLE\",\"name\":\"YSubUnits\",\"type\":\"INTEGER\",\"description\":\" Y sub units\"},{\"mode\": \"NULLABLE\",\"name\":\"ZSubUnits\",\"type\":\"INTEGER\",\"description\":\" Z sub units\"},{\"mode\": \"NULLABLE\",\"name\":\"PegID\",\"type\":\"STRING\",\"description\":\" Peg ID\"},{\"mode\": \"NULLABLE\",\"name\":\"Row\",\"type\":\"INTEGER\",\"description\":\" Row\"},{\"mode\": \"NULLABLE\",\"name\":\"Col\",\"type\":\"INTEGER\",\"description\":\" Col\"},{\"mode\": \"NULLABLE\",\"name\":\"ManualUnits\",\"type\":\"INTEGER\",\"description\":\" Manual units\"},{\"mode\": \"NULLABLE\",\"name\":\"RankX\",\"type\":\"INTEGER\",\"description\":\" Rank X\"},{\"mode\": \"NULLABLE\",\"name\":\"RankY\",\"type\":\"INTEGER\",\"description\":\" Rank Y\"},{\"mode\": \"NULLABLE\",\"name\":\"RankZ\",\"type\":\"INTEGER\",\"description\":\" Rank Z\"},{\"mode\": \"NULLABLE\",\"name\":\"PegSpan\",\"type\":\"INTEGER\",\"description\":\" Peg span\"},{\"mode\": \"NULLABLE\",\"name\":\"AlwaysFLOAT\",\"type\":\"INTEGER\",\"description\":\" Always float\"},{\"mode\": \"NULLABLE\",\"name\":\"PrimaryLabelFormatName\",\"type\":\"STRING\",\"description\":\" Primary position label format name\"},{\"mode\": \"NULLABLE\",\"name\":\"SecondaryLabelFormatName\",\"type\":\"STRING\",\"description\":\" Secondary position label format name\"},{\"mode\": \"NULLABLE\",\"name\":\"MerchXMin\",\"type\":\"INTEGER\",\"description\":\" MerchXMin\"},{\"mode\": \"NULLABLE\",\"name\":\"MerchXMax\",\"type\":\"INTEGER\",\"description\":\" MerchXMax\"},{\"mode\": \"NULLABLE\",\"name\":\"MerchXUprights\",\"type\":\"INTEGER\",\"description\":\" MerchXUprights\"},{\"mode\": \"NULLABLE\",\"name\":\"MerchXCaps\",\"type\":\"INTEGER\",\"description\":\" MerchXCaps\"},{\"mode\": \"NULLABLE\",\"name\":\"MerchXPlacement\",\"type\":\"INTEGER\",\"description\":\" MerchXPlacement\"},{\"mode\": \"NULLABLE\",\"name\":\"MerchXNumber\",\"type\":\"INTEGER\",\"description\":\" MerchXNumber\"},{\"mode\": \"NULLABLE\",\"name\":\"MerchXSize\",\"type\":\"INTEGER\",\"description\":\" MerchXSize\"},{\"mode\": \"NULLABLE\",\"name\":\"MerchXDirection\",\"type\":\"INTEGER\",\"description\":\" MerchXDirection\"},{\"mode\": \"NULLABLE\",\"name\":\"MerchXSqueeze\",\"type\":\"INTEGER\",\"description\":\" MerchXSqueeze\"},{\"mode\": \"NULLABLE\",\"name\":\"MerchYMin\",\"type\":\"INTEGER\",\"description\":\" MerchYMin\"},{\"mode\": \"NULLABLE\",\"name\":\"MerchYMax\",\"type\":\"INTEGER\",\"description\":\" MerchYMax\"},{\"mode\": \"NULLABLE\",\"name\":\"MerchYUprights\",\"type\":\"INTEGER\",\"description\":\" MerchYUprights\"},{\"mode\": \"NULLABLE\",\"name\":\"MerchYCaps\",\"type\":\"INTEGER\",\"description\":\" MerchYCaps\"},{\"mode\": \"NULLABLE\",\"name\":\"MerchYPlacement\",\"type\":\"INTEGER\",\"description\":\" MerchYPlacement\"},{\"mode\": \"NULLABLE\",\"name\":\"MerchYNumber\",\"type\":\"INTEGER\",\"description\":\" MerchYNumber\"},{\"mode\": \"NULLABLE\",\"name\":\"MerchYSize\",\"type\":\"INTEGER\",\"description\":\" MerchYSize\"},{\"mode\": \"NULLABLE\",\"name\":\"MerchYDirection\",\"type\":\"INTEGER\",\"description\":\" MerchYDirection\"},{\"mode\": \"NULLABLE\",\"name\":\"MerchYSqueeze\",\"type\":\"INTEGER\",\"description\":\" MerchYSqueeze\"},{\"mode\": \"NULLABLE\",\"name\":\"MerchZMin\",\"type\":\"INTEGER\",\"description\":\" MerchZMin\"},{\"mode\": \"NULLABLE\",\"name\":\"MerchZMax\",\"type\":\"INTEGER\",\"description\":\" MerchZMax\"},{\"mode\": \"NULLABLE\",\"name\":\"MerchZUprights\",\"type\":\"INTEGER\",\"description\":\" MerchZUprights\"},{\"mode\": \"NULLABLE\",\"name\":\"MerchZCaps\",\"type\":\"INTEGER\",\"description\":\" MerchZCaps\"},{\"mode\": \"NULLABLE\",\"name\":\"MerchZPlacement\",\"type\":\"INTEGER\",\"description\":\" MerchZPlacement\"},{\"mode\": \"NULLABLE\",\"name\":\"MerchZNumber\",\"type\":\"INTEGER\",\"description\":\" MerchZNumber\"},{\"mode\": \"NULLABLE\",\"name\":\"MerchZSize\",\"type\":\"INTEGER\",\"description\":\" MerchZSize\"},{\"mode\": \"NULLABLE\",\"name\":\"MerchZDirection\",\"type\":\"INTEGER\",\"description\":\" MerchZDirection\"},{\"mode\": \"NULLABLE\",\"name\":\"MerchZSqueeze\",\"type\":\"INTEGER\",\"description\":\" MerchZSqueeze\"},{\"mode\": \"NULLABLE\",\"name\":\"Warning\",\"type\":\"STRING\",\"description\":\" Warning\"},{\"mode\": \"NULLABLE\",\"name\":\"WarningNumber\",\"type\":\"INTEGER\",\"description\":\" Warning number\"},{\"mode\": \"NULLABLE\",\"name\":\"Desc1\",\"type\":\"STRING\",\"description\":\" Desc  1\"},{\"mode\": \"NULLABLE\",\"name\":\"Desc2\",\"type\":\"STRING\",\"description\":\" Desc  2\"},{\"mode\": \"NULLABLE\",\"name\":\"Desc3\",\"type\":\"STRING\",\"description\":\" Desc  3\"},{\"mode\": \"NULLABLE\",\"name\":\"Desc4\",\"type\":\"STRING\",\"description\":\" Desc  4\"},{\"mode\": \"NULLABLE\",\"name\":\"Desc5\",\"type\":\"STRING\",\"description\":\" Desc  5\"},{\"mode\": \"NULLABLE\",\"name\":\"Desc6\",\"type\":\"STRING\",\"description\":\" Desc  6\"},{\"mode\": \"NULLABLE\",\"name\":\"Desc7\",\"type\":\"STRING\",\"description\":\" Desc  7\"},{\"mode\": \"NULLABLE\",\"name\":\"Desc8\",\"type\":\"STRING\",\"description\":\" Desc  8\"},{\"mode\": \"NULLABLE\",\"name\":\"Desc9\",\"type\":\"STRING\",\"description\":\" Desc  9\"},{\"mode\": \"NULLABLE\",\"name\":\"Desc10\",\"type\":\"STRING\",\"description\":\" Desc 10\"},{\"mode\": \"NULLABLE\",\"name\":\"Desc11\",\"type\":\"STRING\",\"description\":\" Desc 11\"},{\"mode\": \"NULLABLE\",\"name\":\"Desc12\",\"type\":\"STRING\",\"description\":\" Desc 12\"},{\"mode\": \"NULLABLE\",\"name\":\"Desc13\",\"type\":\"STRING\",\"description\":\" Desc 13\"},{\"mode\": \"NULLABLE\",\"name\":\"Desc14\",\"type\":\"STRING\",\"description\":\" Desc 14\"},{\"mode\": \"NULLABLE\",\"name\":\"Desc15\",\"type\":\"STRING\",\"description\":\" Desc 15\"},{\"mode\": \"NULLABLE\",\"name\":\"Desc16\",\"type\":\"STRING\",\"description\":\" Desc 16\"},{\"mode\": \"NULLABLE\",\"name\":\"Desc17\",\"type\":\"STRING\",\"description\":\" Desc 17\"},{\"mode\": \"NULLABLE\",\"name\":\"Desc18\",\"type\":\"STRING\",\"description\":\" Desc 18\"},{\"mode\": \"NULLABLE\",\"name\":\"Desc19\",\"type\":\"STRING\",\"description\":\" Desc 19\"},{\"mode\": \"NULLABLE\",\"name\":\"Desc20\",\"type\":\"STRING\",\"description\":\" Desc 20\"},{\"mode\": \"NULLABLE\",\"name\":\"Desc21\",\"type\":\"STRING\",\"description\":\" Desc 21\"},{\"mode\": \"NULLABLE\",\"name\":\"Desc22\",\"type\":\"STRING\",\"description\":\" Desc 22\"},{\"mode\": \"NULLABLE\",\"name\":\"Desc23\",\"type\":\"STRING\",\"description\":\" Desc 23\"},{\"mode\": \"NULLABLE\",\"name\":\"Desc24\",\"type\":\"STRING\",\"description\":\" Desc 24\"},{\"mode\": \"NULLABLE\",\"name\":\"Desc25\",\"type\":\"STRING\",\"description\":\" Desc 25\"},{\"mode\": \"NULLABLE\",\"name\":\"Desc26\",\"type\":\"STRING\",\"description\":\" Desc 26\"},{\"mode\": \"NULLABLE\",\"name\":\"Desc27\",\"type\":\"STRING\",\"description\":\" Desc 27\"},{\"mode\": \"NULLABLE\",\"name\":\"Desc28\",\"type\":\"STRING\",\"description\":\" Desc 28\"},{\"mode\": \"NULLABLE\",\"name\":\"Desc29\",\"type\":\"STRING\",\"description\":\" Desc 29\"},{\"mode\": \"NULLABLE\",\"name\":\"Desc30\",\"type\":\"STRING\",\"description\":\" Desc 30\"},{\"mode\": \"NULLABLE\",\"name\":\"Value1\",\"type\":\"FLOAT\",\"description\":\" Value  1\"},{\"mode\": \"NULLABLE\",\"name\":\"Value2\",\"type\":\"FLOAT\",\"description\":\" Value  2\"},{\"mode\": \"NULLABLE\",\"name\":\"Value3\",\"type\":\"FLOAT\",\"description\":\" Value  3\"},{\"mode\": \"NULLABLE\",\"name\":\"Value4\",\"type\":\"FLOAT\",\"description\":\" Value  4\"},{\"mode\": \"NULLABLE\",\"name\":\"Value5\",\"type\":\"FLOAT\",\"description\":\" Value  5\"},{\"mode\": \"NULLABLE\",\"name\":\"Value6\",\"type\":\"FLOAT\",\"description\":\" Value  6\"},{\"mode\": \"NULLABLE\",\"name\":\"Value7\",\"type\":\"FLOAT\",\"description\":\" Value  7\"},{\"mode\": \"NULLABLE\",\"name\":\"Value8\",\"type\":\"FLOAT\",\"description\":\" Value  8\"},{\"mode\": \"NULLABLE\",\"name\":\"Value9\",\"type\":\"FLOAT\",\"description\":\" Value  9\"},{\"mode\": \"NULLABLE\",\"name\":\"Value10\",\"type\":\"FLOAT\",\"description\":\" Value 10\"},{\"mode\": \"NULLABLE\",\"name\":\"Value11\",\"type\":\"FLOAT\",\"description\":\" Value 11\"},{\"mode\": \"NULLABLE\",\"name\":\"Value12\",\"type\":\"FLOAT\",\"description\":\" Value 12\"},{\"mode\": \"NULLABLE\",\"name\":\"Value13\",\"type\":\"FLOAT\",\"description\":\" Value 13\"},{\"mode\": \"NULLABLE\",\"name\":\"Value14\",\"type\":\"FLOAT\",\"description\":\" Value 14\"},{\"mode\": \"NULLABLE\",\"name\":\"Value15\",\"type\":\"FLOAT\",\"description\":\" Value 15\"},{\"mode\": \"NULLABLE\",\"name\":\"Value16\",\"type\":\"FLOAT\",\"description\":\" Value 16\"},{\"mode\": \"NULLABLE\",\"name\":\"Value17\",\"type\":\"FLOAT\",\"description\":\" Value 17\"},{\"mode\": \"NULLABLE\",\"name\":\"Value18\",\"type\":\"FLOAT\",\"description\":\" Value 18\"},{\"mode\": \"NULLABLE\",\"name\":\"Value19\",\"type\":\"FLOAT\",\"description\":\" Value 19\"},{\"mode\": \"NULLABLE\",\"name\":\"Value20\",\"type\":\"FLOAT\",\"description\":\" Value 20\"},{\"mode\": \"NULLABLE\",\"name\":\"Value21\",\"type\":\"FLOAT\",\"description\":\" Value 21\"},{\"mode\": \"NULLABLE\",\"name\":\"Value22\",\"type\":\"FLOAT\",\"description\":\" Value 22\"},{\"mode\": \"NULLABLE\",\"name\":\"Value23\",\"type\":\"FLOAT\",\"description\":\" Value 23\"},{\"mode\": \"NULLABLE\",\"name\":\"Value24\",\"type\":\"FLOAT\",\"description\":\" Value 24\"},{\"mode\": \"NULLABLE\",\"name\":\"Value25\",\"type\":\"FLOAT\",\"description\":\" Value 25\"},{\"mode\": \"NULLABLE\",\"name\":\"Value26\",\"type\":\"FLOAT\",\"description\":\" Value 26\"},{\"mode\": \"NULLABLE\",\"name\":\"Value27\",\"type\":\"FLOAT\",\"description\":\" Value 27\"},{\"mode\": \"NULLABLE\",\"name\":\"Value28\",\"type\":\"FLOAT\",\"description\":\" Value 28\"},{\"mode\": \"NULLABLE\",\"name\":\"Value29\",\"type\":\"FLOAT\",\"description\":\" Value 29\"},{\"mode\": \"NULLABLE\",\"name\":\"Value30\",\"type\":\"FLOAT\",\"description\":\" Value 30\"},{\"mode\": \"NULLABLE\",\"name\":\"Flag1\",\"type\":\"INTEGER\",\"description\":\" Flag  1\"},{\"mode\": \"NULLABLE\",\"name\":\"Flag2\",\"type\":\"INTEGER\",\"description\":\" Flag  2\"},{\"mode\": \"NULLABLE\",\"name\":\"Flag3\",\"type\":\"INTEGER\",\"description\":\" Flag  3\"},{\"mode\": \"NULLABLE\",\"name\":\"Flag4\",\"type\":\"INTEGER\",\"description\":\" Flag  4\"},{\"mode\": \"NULLABLE\",\"name\":\"Flag5\",\"type\":\"INTEGER\",\"description\":\" Flag  5\"},{\"mode\": \"NULLABLE\",\"name\":\"Flag6\",\"type\":\"INTEGER\",\"description\":\" Flag  6\"},{\"mode\": \"NULLABLE\",\"name\":\"Flag7\",\"type\":\"INTEGER\",\"description\":\" Flag  7\"},{\"mode\": \"NULLABLE\",\"name\":\"Flag8\",\"type\":\"INTEGER\",\"description\":\" Flag  8\"},{\"mode\": \"NULLABLE\",\"name\":\"Flag9\",\"type\":\"INTEGER\",\"description\":\" Flag  9\"},{\"mode\": \"NULLABLE\",\"name\":\"Flag10\",\"type\":\"INTEGER\",\"description\":\" Flag 10\"},{\"mode\": \"NULLABLE\",\"name\":\"LocationID\",\"type\":\"INTEGER\",\"description\":\" Location ID\"},{\"mode\": \"NULLABLE\",\"name\":\"UseTargetSpaceX\",\"type\":\"INTEGER\",\"description\":\" Use target space X\"},{\"mode\": \"NULLABLE\",\"name\":\"UseTargetSpaceY\",\"type\":\"INTEGER\",\"description\":\" Use target space Y\"},{\"mode\": \"NULLABLE\",\"name\":\"UseTargetSpaceZ\",\"type\":\"INTEGER\",\"description\":\" Use target space Z\"},{\"mode\": \"NULLABLE\",\"name\":\"TargetSpaceX\",\"type\":\"FLOAT\",\"description\":\" Target space X\"},{\"mode\": \"NULLABLE\",\"name\":\"TargetSpaceY\",\"type\":\"FLOAT\",\"description\":\" Target space Y\"},{\"mode\": \"NULLABLE\",\"name\":\"TargetSpaceZ\",\"type\":\"FLOAT\",\"description\":\" Target space Z\"},{\"mode\": \"NULLABLE\",\"name\":\"Capacity\",\"type\":\"INTEGER\",\"description\":\" Capacity\"},{\"mode\": \"NULLABLE\",\"name\":\"Units\",\"type\":\"INTEGER\",\"description\":\" Units\"},{\"mode\": \"NULLABLE\",\"name\":\"Linear\",\"type\":\"FLOAT\",\"description\":\" Linear\"},{\"mode\": \"NULLABLE\",\"name\":\"Square\",\"type\":\"FLOAT\",\"description\":\" Square\"},{\"mode\": \"NULLABLE\",\"name\":\"Cubic\",\"type\":\"FLOAT\",\"description\":\" Cubic\"},{\"mode\": \"NULLABLE\",\"name\":\"TargetInventory\",\"type\":\"INTEGER\",\"description\":\" Target inventory\"},{\"mode\": \"NULLABLE\",\"name\":\"Facings\",\"type\":\"INTEGER\",\"description\":\" Facings\"},{\"mode\": \"NULLABLE\",\"name\":\"IndexInPlanogram\",\"type\":\"INTEGER\",\"description\":\" Index in planogram\"},{\"mode\": \"NULLABLE\",\"name\":\"Segment\",\"type\":\"INTEGER\",\"description\":\" Segment\"},{\"mode\": \"NULLABLE\",\"name\":\"FirstSegment\",\"type\":\"INTEGER\",\"description\":\" First Segment\"},{\"mode\": \"NULLABLE\",\"name\":\"LastSegment\",\"type\":\"INTEGER\",\"description\":\" Last Segment\"},{\"mode\": \"NULLABLE\",\"name\":\"ImageSource\",\"type\":\"STRING\",\"description\":\" Image Source\"},{\"mode\": \"NULLABLE\",\"name\":\"PegIDUsed\",\"type\":\"STRING\",\"description\":\" Peg ID used\"},{\"mode\": \"NULLABLE\",\"name\":\"ReplenishmentMin\",\"type\":\"INTEGER\",\"description\":\" Replenishment min\"},{\"mode\": \"NULLABLE\",\"name\":\"ReplenishmentMax\",\"type\":\"INTEGER\",\"description\":\" Replenishment max\"},{\"mode\": \"NULLABLE\",\"name\":\"ShapeID\",\"type\":\"STRING\",\"description\":\" Shape ID\"},{\"mode\": \"NULLABLE\",\"name\":\"BitmapIDOverride\",\"type\":\"STRING\",\"description\":\" Bitmap ID Override\"},{\"mode\": \"NULLABLE\",\"name\":\"HideIfPrINTEGERing\",\"type\":\"INTEGER\",\"description\":\" Hide if printing\"},{\"mode\": \"NULLABLE\",\"name\":\"PartID\",\"type\":\"STRING\",\"description\":\" Part ID\"},{\"mode\": \"NULLABLE\",\"name\":\"BitmapIDOverrideUnit\",\"type\":\"INTEGER\",\"description\":\" Bitmap ID Override Unit\"},{\"mode\": \"NULLABLE\",\"name\":\"CapacityUnrestricted\",\"type\":\"INTEGER\",\"description\":\" Capacity Unrestricted\"},{\"mode\": \"NULLABLE\",\"name\":\"AutomaticModel\",\"type\":\"INTEGER\",\"description\":\" Automatic Model\"},{\"mode\": \"NULLABLE\",\"name\":\"CustomData\",\"type\":\"STRING\",\"description\":\" Custom Data\"},{\"mode\": \"NULLABLE\",\"name\":\"XCapWithUnits\",\"type\":\"INTEGER\",\"description\":\" X cap with units\"},{\"mode\": \"NULLABLE\",\"name\":\"YCapWithUnits\",\"type\":\"INTEGER\",\"description\":\" Y cap with units\"},{\"mode\": \"NULLABLE\",\"name\":\"ZCapWithUnits\",\"type\":\"INTEGER\",\"description\":\" Z cap with units\"},{\"mode\": \"NULLABLE\",\"name\":\"FILE_NAME_DATE\",\"type\":\"STRING\",\"description\":\" file name date\"}]";	
		try{

			
			 List<String> fileNameList = StorageService.readFileFromStorageFolder(BUCKETNAME, "IX_SPC_POSITION_", "positionProcess");
			 log.info("Total files" + fileNameList.size());
			 if(fileNameList.size() == 0){		 
				
					log.info("No Files found");
					MailUser.sendMail(PROJECT_NAME + " : DUP_IX_SPC_POSITION Notification","No Files found after unzipping"); 
			 }
			 
			 for(int i =0 ; i<fileNameList.size(); i++ ){
					
					
					String dataformat = fileNameList.get(i).replace("IX_SPC_POSITION_", "");
					dataformat = dataformat.substring(0, 8);
					
					String tableSpec = PROJECT_NAME + ":JDA_Tables.IX_SPC_POSITION";
					String tableErrorSpec  = PROJECT_NAME+":JDA_Error.IX_SPC_POSITION_ErrorLog";
					
					
					String successtable = tableSpec + "_" + dataformat;
					String errorTable = tableErrorSpec + "_" + dataformat;

					String filepath = "gs://"+ BUCKETNAME   + "/positionProcess/" + fileNameList.get(i);
					StorageService.deletingFileFromStorage(BUCKETNAME, "IX_SPC_POSITION_"+dataformat);
					//StorageService.copyingFilefromPath(BUCKETNAME,BUCKETNAME_ARCHIVE,  fileNameList.get(i), "");
					DataFlowProcessForJDA.run(sampleSchema,successtable,errorTable,TEMPLOCATION,filepath,"","DBTime",DelimiterType.PIPE,"IX_SPC_POSITION_"+dataformat);		
					DeleteErrorTable.deleteErrorTable("IX_SPC_POSITION_ErrorLog_" + dataformat, "JDA_Error",errorTable,"IX_SPC_POSITION");	
					DeleteErrorTable.successTableNotification("IX_SPC_POSITION_"+ dataformat, "JDA_Tables", successtable, "IX_SPC_POSITION");					
					StorageService.deletingFileFromStorageFromProcessing(BUCKETNAME, fileNameList.get(i), "positionProcess");
					log.info("Dataflow completed for Product");
				}
			}
			catch(Exception e){
				log.info("Exception Occured : " + e.getLocalizedMessage());
				MailUser.sendMail(PROJECT_NAME + " : DUP_IX_SPC_POSITION Notification","Job failed because of below reason : " + e.getMessage()); 
			}
		}
	}	